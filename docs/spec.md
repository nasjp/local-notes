# Prompt Storage — 要件整理（MVP）

## 1) 目的・スコープ

* **目的**：LLM用プロンプトを**ローカルのみ**で簡単に保存・参照・検索できる軽量Webアプリを提供する。
* **スコープ（MVP）**：

  * ローカルストレージへの保存／更新／削除
  * 一覧（カードタイル表示）・詳細（タイトル＋テキストエリア）
  * **部分一致のインタラクティブ検索**（タイトル・本文が対象）
  * **レスポンシブ**対応（モバイル〜デスクトップ）
  * UIは**shadcn/ui**のデフォルトコンポーネント中心で構成

## 2) 画面要件 / レイアウト

### 共通

* 画面中央上段に\*\*アプリタイトル“Prompt Storage”\*\*を表示。
* タイトル下に**検索バー**、その下に**タイル状カードの一覧**。
* 余白・行間は読みやすさ優先。ダーク/ライトはブラウザの設定に追従（MVPでは切替UIなしでも可）。

### 一覧画面

* **ヘッダー**：

  * `Heading`（中央寄せ）：「Prompt Storage」
  * 直下に`Input`：プレースホルダ「Search...」など
  * 右上または検索バー右端付近に「+ New」ボタン（新規作成）
* **カードタイル（Grid）**：

  * 各カード：`Card`（shadcn/ui）
  * 表示項目：**タイトル**（1行省略）／**本文の先頭部分**（2〜3行でトランケート）
  * クリックで詳細画面へ遷移
* **レスポンシブ**（目安）：

  * `sm`: 1列、`md`: 2列、`lg`: 3列、`xl`: 4列
  * 本文トランケーションはCSSのline-clampで実装
* **空状態**：

  * 0件時は空状態カード（アイコン＋「プロンプトがありません。‘+ New’で作成」）

### 詳細画面

* フォーム構成：

  * `Input`：**タイトル**（必須）
  * `Textarea`：**プロンプト本文**
  * `Button`：Save / Delete（MVPはSaveが必須、Deleteは任意だが有用）
* 動作：

  * Saveでローカルストレージに書き込み、`updatedAt`更新
  * Deleteで確認ダイアログ後に削除 → 一覧へ戻る

## 3) 検索仕様（インタラクティブ）

* **対象**：タイトルと本文
* **一致方法**：**部分一致（case-insensitive）**
* **タイミング**：入力のたびにフィルタ（200ms程度のデバウンス）
* **結果**：一致件のみカード表示／0件時は「該当なし」状態表示
* **並び順**：`updatedAt`の降順（新しい順）をデフォルト

## 4) データモデル & 永続化（localStorage）

* **ストレージキー**：`prompt-storage:v1`
* **構造**：配列 or マップ（MVPは配列で十分）

```ts
type Prompt = {
  id: string;           // UUID等
  title: string;        // 必須
  body: string;         // プロンプト本文
  createdAt: string;    // ISO8601
  updatedAt: string;    // ISO8601
};
type Store = {
  prompts: Prompt[];
  version: 1;
};
```

* **読み書き方針**：

  * 初回は空配列で初期化
  * 保存時：配列内に存在すれば置換、なければ追加
  * 削除時：`id`一致で除去
  * 例外：\*\*容量超過時（QuotaExceededError）\*\*はユーザーに通知

## 5) ユースケース / ユーザーストーリー（MVP）

* **作成**：ユーザーは「+ New」からタイトル・本文を入力し保存できる。
* **閲覧**：一覧でカードから内容の冒頭を把握できる。
* **検索**：検索バーに入力すると瞬時にカードが絞り込まれる。
* **編集**：詳細画面で内容を更新し保存できる。
* **削除**（推奨）：不要になったプロンプトを削除できる。

## 6) 非機能要件

* **パフォーマンス**：100件程度のローカルデータで快適に検索（O(n)線形検索でOK）
* **レスポンシブ**：モバイル（幅320px想定）〜デスクトップまで快適
* **アクセシビリティ**：

  * 入力要素に`label`/`aria-*`適用
  * キーボード操作可能（Tab移動、Enter保存等）
* **プライバシー/セキュリティ**：

  * データは**ブラウザローカルのみ**。サーバ通信なし
  * 共有端末での利用注意喚起（MVPは警告テキストで可）

## 7) コンポーネント（shadcn/ui想定）

* 見出し：`Typography` or `h1`スタイル
* 入力：`Input`（検索・タイトル）、`Textarea`（本文）
* ボタン：`Button`（Save / New / Delete）
* カード：`Card`, `CardHeader`, `CardTitle`, `CardContent`
* ダイアログ：`AlertDialog`（削除確認）
* トースト：`Toast`（保存成功・エラー表示）
* グリッド：Tailwindユーティリティ + コンテナ

## 8) ルーティング/ナビゲーション

* `"/"`：一覧
* `"/new"`：新規作成
* `"/p/:id"`：詳細（閲覧/編集）
* 保存/削除後は**一覧へ戻る** or 詳細に留まる（MVPは戻る方針がわかりやすい）

## 9) 操作フロー（概要）

1. 一覧表示 → 検索入力で絞り込み
2. 「+ New」→ 詳細で入力 → Save → 一覧
3. 一覧のカードクリック → 詳細で編集 → Save → 一覧
4. 不要なら Delete（確認）→ 一覧

## 10) エッジケース / エラーハンドリング

* **保存時エラー**（容量超過・JSON破損）：トーストで案内＋復旧ガイド（例：エクスポートしてから削除）
* **タイトル未入力**：保存不可（バリデーション表示）
* **データ破損**：復旧不能時は初期化の提案（バックアップがある場合はインポート案内）※MVPはテキスト説明のみ

## 11) 受入基準（サンプル）

* [ ] タイトルと本文を保存でき、一覧に即時反映される
* [ ] 検索によりタイトル/本文の部分一致でフィルタリングされる
* [ ] カードでタイトル1行・本文2〜3行で綺麗に省略される
* [ ] モバイル/デスクトップ双方で崩れない
* [ ] ブラウザを再読み込みしてもデータが残る
* [ ] 削除確認が表示され、削除後に一覧から消える

## 12) 実装メモ（推奨・参考）

* フレームワーク：React + TypeScript（任意でNext.js or Vite）
* スタイル：Tailwind（shadcn/ui前提）、`line-clamp`で本文トランケート
* 検索：`toLowerCase().includes()`で簡易実装、200msデバウンス
* ID：`crypto.randomUUID()`（対応ブラウザ外なら代替）
* ストレージ：単一キーに全件保持（件数100〜300を想定）

## 13) 今後の拡張候補（Backlog）

* **エクスポート/インポート**（JSONファイルでバックアップ/移行）
* ピン留め／お気に入り／並び替え
* マークダウン表示プレビュー
* タグ・フォルダ分類、AND/OR検索、ハイライト
* オートセーブ（フォーカスアウト or 入力停止時）
* 共有リンク（※サーバ要るためスコープ外）
* ショートカット（`⌘/Ctrl + K`検索、`⌘/Ctrl + N`新規）
